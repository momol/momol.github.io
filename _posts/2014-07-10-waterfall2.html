---
layout: default
title: 瀑布流布局jQuery
---
<style>
	*{padding: 0;margin: 0;}
	#main{position: relative;}
	.box{padding-top: 15px;padding-left: 15px;float: left;}
	.pic{padding: 10px;border: 1px solid #fff;box-shadow: 0 0 1px rgb(0,0,0);border-radius: 5px;}
	.pic img{width: 165px;height: auto;}
</style>
<script src="/style/base/jquery/jquery.min.js"></script>
<script>
$(window).on('load',function() {
	waterfall();
	var dataInt={"data":[
	{"src":'0.jpg'},
	{"src":'1.jpg'},
	{"src":'2.jpg'},
	{"src":'3.jpg'},
	{"src":'5.jpg'},
	{"src":'6.jpg'},
	{"src":'7.jpg'},
	{"src":'8.jpg'},
	]}
	$(window).on('scroll',function(){
		if(checkScrollSlide()){
			// console.log('load')
			$.each(dataInt.data,function(key,value){
				var oBox=$('<div>').addClass('box').appendTo($('#main'));
				var oPic=$('<div>').addClass('pic').appendTo($(oBox));
				$('<img>').attr('src','/mod/pinterest/javascript/images/'+$(value).attr('src')).appendTo($(oPic))
			});
			waterfall();
		}
	})
});
function waterfall(){
	var $boxs=$('#main>div');
	var w=$boxs.eq(0).outerWidth();
	var cols=Math.floor($(window).width()/w);
	$('#main').width(w*cols);
	var hArr=[];
	$boxs.each(function(index,value){
		// console.log(value)
		var h=$boxs.eq(index).outerHeight();
		if(index<cols){
			hArr[index]=h;
		}else{
			var minH=Math.min.apply(null,hArr);
			var minHIndex=$.inArray(minH,hArr);
			//value DOM对象转jQuery对象
			$(value).css({
				'position':'absolute',
				'top':minH+'px',
				'left':minHIndex*w+'px'
			});
			hArr[minHIndex]+=$boxs.eq(index).outerHeight();
		}
	});
}
function checkScrollSlide(){
	var $lastBox=$('#main>div').last();
	var lastBoxDis=$lastBox.offset().top+Math.floor($lastBox.outerHeight()/2);
	var scrollTop=$(window).scrollTop();
	var documentH=$(window).height();
	return (lastBoxDis<scrollTop+documentH)?true:false;
}
</script>
<div id="main">
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_00.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_01.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_02.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_03.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_04.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_05.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_06.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_07.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_08.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_09.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_010.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_011.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_012.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_013.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_014.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_015.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_016.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_017.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_018.jpg" alt=""></div>
	</div>
	<div class="box">
		<div class="pic"><img src="/mod/pinterest/css3/images/p_019.jpg" alt=""></div>
	</div>
</div>